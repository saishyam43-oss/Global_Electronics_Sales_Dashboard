# DAX Measures: Data Cleaning Summary

This file contains all the DAX measures used to power the `Data Cleaning Summary` dashboard. The measures are built on top of the static summary tables (found in the `Data_Cleaning_Tables` folder) which were generated by the SQL cleaning scripts.

---

```dax
// =====================================================
// Data Cleaning Summary Dashboard - DAX Measures
// Author: Saishyam T
// Description: DAX formulas for metrics, KPIs, and reliability in the data_cleaning_summary dashboard.
//    Each section contains well-documented measures by topic/table.
// =====================================================

/* ===============================
    AGGREGATED TABLE MEASURES
   =============================== */

// Consistent Date Formatting
// Sums the "Total Rows After" for all tables to display the count of rows with correct date formatting.
Consistent Date Formatting = 
SUMX(
    FILTER(
        Aggregated,
        Aggregated[Metric_Name]="Total Rows After"
    ),
    COALESCE(Aggregated[Sales], 0) +
    COALESCE(Aggregated[Customers], 0) +
    COALESCE(Aggregated[Products], 0) +
    COALESCE(Aggregated[Stores], 0) +
    COALESCE(Aggregated[Exchange Rates], 0)
)

// Inconsistent Date Formatting
// Sums count of date formatting issues across tables.
Inconsistent Date Formatting = 
SUMX(
    FILTER(
        Aggregated,
        Aggregated[Metric_Name]="Corrected: Inconsistent Date formatting"
    ),
    COALESCE(Aggregated[Sales], 0) +
    COALESCE(Aggregated[Customers], 0) +
    COALESCE(Aggregated[Products], 0) +
    COALESCE(Aggregated[Stores], 0) +
    COALESCE(Aggregated[Exchange Rates], 0)
)

// Date Formatting (KPI - displays transition using arrow symbol)
// Shows "before → after" summary for rows with consistent date formatting.
Date formatting = 
VAR Prev = [Consistent Date Formatting] - [Inconsistent Date Formatting]
VAR Curr = [Consistent Date Formatting]
VAR Arrow = UNICHAR(8594)  // Unicode right arrow →
RETURN
Prev & " " & Arrow & " " & Curr


/* ==================
    CUSTOMERS_METRICS
   ================== */

// % of values impacted by cleaning (Customers)
Customers = DIVIDE(
    SUMX(
        FILTER(
            Customers_Metrics,
            Customers_Metrics[Metrics] <> "Total Rows Before" &&
            Customers_Metrics[Metrics] <> "Total Rows After"
        ),
        Customers_Metrics[Value]
    ),
    MAXX(
        FILTER(
            Customers_Metrics, 
            Customers_Metrics[Metrics] = "Total Rows Before"
        ),
        Customers_Metrics[Value]
    )
)

// Percentage of Duplicates Flagged (Customers)
Duplicates flagged C% = CALCULATE(
    MAXX(
        FILTER(
            Customers_Metrics,
            Customers_Metrics[Metrics] == "Flagged: Duplicates"
        ),
        Customers_Metrics[Value]
    )
    /
    MAXX(
        FILTER(
            Customers_Metrics,
            Customers_Metrics[Metrics] == "Total Rows Before"
        ),
        Customers_Metrics[Value]
    )
)


/* ============================
    EXCHANGE RATE METRICS
   ============================ */

// % of Exchange Rate values impacted
Exchange_Rates = DIVIDE(
    SUMX(
        FILTER(
            Exchange_Rates_Metrics,
            Exchange_Rates_Metrics[Metrics] <> "Total Rows Before" &&
            Exchange_Rates_Metrics[Metrics] <> "Total Rows After"
        ),
        Exchange_Rates_Metrics[Values]
    ),
    MAXX(
        FILTER(
            Exchange_Rates_Metrics, 
            Exchange_Rates_Metrics[Metrics] = "Total Rows Before"
        ),
        Exchange_Rates_Metrics[Values]
    )
)


/* ======================
    GEO RELIABILITY
   ====================== */

// Reliability in City to State Mappings (Sales-only)
City_State Reliability = MAXX(
    FILTER(
        Geo_Reliability,
        Geo_Reliability[Level] = "City_State"
    ),
    Geo_Reliability[Reliability_in_Sales]
)

// Reliability in State to Country Mappings (Sales-only)
State_Country Reliability = MAXX(
    FILTER(
        Geo_Reliability,
        Geo_Reliability[Level] = "State_Country"
    ),
    Geo_Reliability[Reliability_in_Sales]
)


/* =====================
    PRODUCTS_METRICS
   ===================== */

// % of Product values impacted by cleaning
Products = DIVIDE(
    SUMX(
        FILTER(
            Products_Metrics,
            Products_Metrics[Metrics] <> "Total Rows Before" &&
            Products_Metrics[Metrics] <> "Total Rows After"
        ),
        Products_Metrics[Value]
    ),
    MAXX(
        FILTER(
            Products_Metrics, 
            Products_Metrics[Metrics] = "Total Rows Before"
        ),
        Products_Metrics[Value]
    )
)

// Duplicates Flagged% for Products
Duplicates flagged P% = CALCULATE(
    MAXX(
        FILTER(
            Products_Metrics,
            Products_Metrics[Metrics] == "Flagged: Duplicates"
        ),
        Products_Metrics[Value]
    )
) -- NOTE: Your original measure was missing the closing parenthesis for CALCULATE.


/* =====================
    SALES_METRICS
   ===================== */

// Invalid Sales Removed
// Difference between before and after row counts
Invalid Sales Removed = CALCULATE(
    MAXX(
        FILTER(
            Sales_Metrics,
            Sales_Metrics[Metrics] == "Total Rows Before"
        ),
        Sales_Metrics[Value]
    )
    -
    MAXX(
        FILTER(
            Sales_Metrics,
            Sales_Metrics[Metrics] == "Total Rows After"
        ),
        Sales_Metrics[Value]
    )
)

// % of Sales records impacted by cleaning
Sales = DIVIDE(
    SUMX(
        FILTER(
            Sales_Metrics,
            Sales_Metrics[Metrics] <> "Total Rows Before" &&
            Sales_Metrics[Metrics] <> "Total Rows After"
        ),
        Sales_Metrics[Value]
    ),
    MAXX(
        FILTER(
            Sales_Metrics, 
            Sales_Metrics[Metrics] = "Total Rows Before"
        ),
        Sales_Metrics[Value]
    )
)


/* ======================
    STORES_METRICS
   ====================== */

// % of Stores values impacted by cleaning
Stores = DIVIDE(
    SUMX(
        FILTER(
            Stores_Metrics,
            Stores_Metrics[Metrics] <> "Total Rows Before" &&
            Stores_Metrics[Metrics] <> "Total Rows After"
        ),
        Stores_Metrics[Value]
    ),
    MAXX(
        FILTER(
            Stores_Metrics, 
            Stores_Metrics[Metrics] = "Total Rows Before"
        ),
        Stores_Metrics[Value]
    )
)
// Duplicates Flagged% for Stores
Duplicates flagged S% = CALCULATE(
    MAXX(
        FILTER(
            Stores_Metrics,
            Stores_Metrics[Metrics] == "Flagged: Duplicates"
        ),
        Stores_Metrics[Value]
    )
    /
    MAXX(
        FILTER(
            Stores_Metrics,
            Stores_Metrics[Metrics] == "Total Rows Before"
        ),
        Stores_Metrics[Value]
    )
)


/* =====================
    SUMMARY TABLE
   ===================== */

// Count of Accepted Issues
Accepted = 
CALCULATE(
    COUNTROWS('Summary_Table'),
    SEARCH("Accepted", 'Summary_Table'[Action_Taken], 1, 0) > 0
)

// Count of Corrected Issues
Corrected = 
CALCULATE(
    COUNTROWS('Summary_Table'),
    SEARCH("Corrected", 'Summary_Tale'[Action_Taken], 1, 0) > 0
)

// Total Issues in Summary Table
Total Issues = COUNT( Summary_Table[Issue] )

// =====================
// END OF FILE
// =====================
